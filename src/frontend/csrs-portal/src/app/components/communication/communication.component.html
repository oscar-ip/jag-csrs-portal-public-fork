<div class="container">
  <section>
    <div>
      <h1 class="mb-5">Welcome, {{portalUser}}</h1>
      <hr style="opacity: 1; color: #fcba19" />
    </div>
  </section>
  <section>
    <div class="flex-6-col">
      <mat-tab-group animationDuration="0ms" [selectedIndex]="selectedTab">
        <mat-tab>
          <ng-template mat-tab-label>
            <h1 class="mb-1 tabHeader">Inbox (1)</h1>
          </ng-template>
          <div class="step1" style="border: 1px solid black;" *ngIf="!toggleRow">
            <div class="mb-3 mt-5">
              <div class="container">
                <div class="row">
                  <div class="col-md-1">
                    <h2 style="font-weight: bold;">File #:</h2>
                  </div>
                  <div class="col-md-1">
                    <input style="width: 100%;" type="input" #fileNumber value="4652" class="font_bold"/>
                  </div>
                  <div class="col-md-10">
                    <div style="float: right;">
                      <h2 class="font_normal">
                        New message
                      </h2>
                    </div>

                  </div>
                </div>
              </div>
            </div>
            <hr class="mt-0 mb-4" style="opacity: 0.5">

            <table mat-table [dataSource]="dataSource">

              <ng-container   matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef style="font-weight: bold;"> Date </th>
                <td mat-cell  *matCellDef="let element"> {{element.date}} </td>
              </ng-container>

              <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef> File # </th>
                <td mat-cell *matCellDef="let element"> {{element.file}} </td>
              </ng-container>

              <ng-container matColumnDef="username">
                <th mat-header-cell *matHeaderCellDef> Subject </th>
                <td mat-cell *matCellDef="let element"> {{element.subject}} </td>
              </ng-container>

              <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef> Attachment </th>
                <td mat-cell *matCellDef="let element"> {{element.attachment}} </td>
              </ng-container>

              <ng-container matColumnDef="phone">
                <th mat-header-cell *matHeaderCellDef> Actions </th>
                <td class="font_normal" mat-cell *matCellDef="let element"> <a target="blank" (click)="ontable(element)" >View</a> </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns;"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            </table>
          </div>

          <div class="step2" *ngIf="toggleRow">
            <div class="mb-3 mt-5">
              <div class="container">
                <p class="back-to-messages" (click)="ontable('')"><mat-icon style="vertical-align:middle;">arrow_back</mat-icon>  Back to all messages</p>
                <div class="row">
                  <div class="col-md-2">
                    <h2 style="font-weight: bold;">File #: <span style="font-size: 14px;color: black;" >4652</span>  </h2>
                  </div>
                  <div class="col-md-5">
                    <h2 style="font-weight: bold;">Date : <span  style="font-size: 14px;color: black;" >10/12/2021</span> </h2>
                  </div>
                </div>
              </div>
            </div>
            <hr class="mt-0 mb-4" style="opacity: 1">

            <div class="section">
              <h2>Message</h2>
              <div class="message-data">
                 <h2><strong>Your Notice of assessment for 2021 is availble</strong></h2>
                 <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
              </div>
              <table class="table">
                <tr>
                  <th>Attachment(s)</th>
                  <th>File size</th>
                  <th>Actions</th>
                </tr>

                <tr class="text-dark">
                 <td><strong>Notice-Assessment-10203.pdf</strong></td>
                 <td>1 MB</td>
                 <td><a href="#">Download</a></td>
               </tr>

               </table>
            </div>
          </div>
        </mat-tab>
        <mat-tab>
          <ng-template mat-tab-label>
            <h1 class="mb-1 tabHeader">Upload Document</h1>
          </ng-template>
          <form [formGroup]="uploadFormGroup" class="round1" style="padding-bottom: 20px">
            <div class="mb-3">
              <div class="container">
                <div class="row">
                  <div class="col-1">
                    <h2 style="font-weight: bold;">File #:</h2>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <mat-label>Select File</mat-label>
                      <mat-select formControlName="uploadFile" (selectionChange)="onUploadFileNumberChange ($event)">
                        <mat-option *ngFor="let file of files" [value]="file.fileId">
                          {{file.fileNumber}}
                        </mat-option>
                      </mat-select>
                      <mat-error *ngIf="uploadFile.hasError('required')">
                        File is required.
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div class="col-8">
                    <h2 class="text-dark">
                      You may only upload one document at a time
                    </h2>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-drag-container">
              <div class="dropzone">
                <input class="drop-file" type="file"
                       #fileDropRef id="fileDropRef"
                       accept=".pdf,.gif,.jpg,.jpeg,.png"
                       (change)="onFileSelected($event)"
                       />
                <h2 class="font_bold">Drag and drop file here or
                  <a
                    class ='browse-file'
                    style="cursor:pointer"
                    (click)="fileDropRef.click()"
                  >
                  Choose Documents.
                  </a>
                </h2>
                <p class="text-dark">(one document per upload - 10 MB max)</p>
              </div>
            </div>


            <div class="mt-3 mb-3" *ngIf="selectedFile">
              <div class="container">
                <h2 class="font_normal">
                  Selected document type:
                </h2>
                <div class="row round2">
                  <div class="col-md-5 mt-3 mb-3" style="display: inline-flex; vertical-align: middle;">
                    <span class="file_name_icon">
                      <mat-icon class="mat-icon-black">text_snippet</mat-icon>
                    </span>
                    <span class="file_name">{{selectedFile.name}}</span>
                  </div>

                  <div class="col-md-2 mt-3 mb-3">
                    <label class="font_bold" for="documentType">Document Type:
                      <span class="asterick">*</span>
                    </label>
                  </div>
                  <div class="col mt-3 mb-3">
                    <select class="form-control" style="width: fit-content;"
                    (change)="onDocTypeChanged($event)">
                      <option *ngFor="let documentType of documentTypes" [ngValue]="documentType.id">{{documentType.docType}}</option>
                    </select>
                  </div>
                  <div class="col mt-3 mb-3">
                    <span class="file_name_icon" style="text-align: right;">
                      <mat-icon class="mat-icon-red"  (click)="onDeleteFile()">delete_forever</mat-icon>
                    </span>
                  </div>
                  </div>
                </div>
              </div>

            <div class="mt-3 mb-3">
              <div class="container">
                <div class="row">
                  <div class="col" style="text-align: right;" >
                    <button mat-flat-button
                            type="button"
                            class="BC-Gov-PrimaryButton"
                            color="primary"
                            style="width: 250px; float:right;"
                            (click)="onUpload()">
                      Upload Document
                    </button>
                  </div>
                </div>
              </div>
            </div>

          </form>

          <div class="mt-3 mb-3 p-2 round4">
            <mat-grid-list cols="6" rowHeight="55px" gutterSize="5px">
              <mat-grid-tile colspan="1" rowspan="2" aria-rowindex="0">
                <img class="icon-size5" src="/assets/Support_icon.svg" />
              </mat-grid-tile>
              <mat-grid-tile colspan="5" rowspan="1" aria-rowindex="0">
                <p class="text-left-inside-grid font_size_24_bolder">
                  Have questions or looking for more support?
                </p>
              </mat-grid-tile>
              <mat-grid-tile colspan="5" rowspan="1" aria-rowindex="1" class="text-left-inside-grid">
                <p class="font_size_18_lighter">
                  Contact the recalculation service toll free at
                  <a
                      [attr.href]="bceIdLink"
                      target="_blank"
                      rel="noopener"
                      class="useful-links bceIdLink"
                    >
                    1-866-660-2684
                  </a>
                  or learn more about the program
                  <a
                      [attr.href]="bceIdLink"
                      target="_blank"
                      rel="noopener"
                      class="useful-links bceIdLink"
                    >
                      in here.
                    </a>
                </p>
              </mat-grid-tile>
            </mat-grid-list>
          </div>


        </mat-tab>
        <mat-tab>
          <ng-template mat-tab-label>
            <h1 class="mb-1 tabHeader">Contact Us</h1>
          </ng-template>
          <form [formGroup]="contactFormGroup" class="round1 form-control" style="padding-bottom: 20px">
            <div class="mb-3">
              <div class="container">
                <section class="bc-gov-alertbanner-success" *ngIf="showSuccessMessages">
                  <p *ngFor="let message of successMessages">
                    <span class="app-cancel">
                      {{message}}
                    </span>
                  </p>
                </section>
                <div class="row">
                  <div class="col-1">
                    <label style="font-weight: bold;">File #:</label>
                  </div>
                  <div class="col">
                    <mat-form-field>
                      <mat-label>Select File</mat-label>
                      <mat-select formControlName="contactFile" (selectionChange)="onContactFileNumberChange ($event)">
                        <mat-option *ngFor="let file of files" [value]="file.fileId">
                          {{file.fileNumber}}
                        </mat-option>
                      </mat-select>
                      <mat-error *ngIf="contactFile.hasError('required')">
                        File is required.
                      </mat-error>
                    </mat-form-field>
                  </div>
                  <div class="col-2">
                    <label style="font-weight: bold;">Date:</label>
                    {{contactDate}}
                  </div>
                  <div class="col">

                  </div>
                </div>
                <div class="row">
                  <hr size="4" width="90%">
                </div>
                <div class="row">
                  <div class="col-1 w-100">
                    <label style="font-weight: bold;">Subject:</label>
                    <mat-form-field class="w-100">
                      <mat-label>Choose the subject you are inquiring about</mat-label>
                      <mat-select formControlName="contactSubject">
                        <mat-option *ngFor="let subject of contactSubjects" [value]="subject.name">
                          {{subject.name}}
                        </mat-option>
                      </mat-select>
                      <mat-error *ngIf="contactSubject.hasError('required')">
                        Subject is required.
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="md-textarea">
                    <label style="font-weight: bold;">Message:</label>
                    <mat-form-field class="w-100">
                      <textarea matInput
                                placeholder="Type your message here ... 500 character max"
                                [formControl]="contactMessage"
                                rows="4">
                        </textarea>
                      <mat-error *ngIf="contactMessage.hasError('required')">
                        Message is required.
                      </mat-error>
                      <mat-error *ngIf="contactMessage.hasError('maxlength')">
                        Max length is 500.
                      </mat-error>
                    </mat-form-field>

                  </div>
                </div>
                <div class="row">
                  <section class="bc-gov-alertbanner-error" *ngIf="showValidationMessages">
                    <p *ngFor="let message of validationMessages">
                      <span class="app-cancel">
                        {{message}}
                      </span>
                    </p>
                  </section>
                </div>
                <div class="row">
                  <div class="col-1">
                    <button mat-flat-button
                            type="button"
                            class="BC-Gov-SecondaryButton"
                            style="width: 250px;"
                            (click)="clearContactForm()">
                      Cancel
                    </button>
                  </div>
                  <div class="col">

                  </div>
                  <div class="col-8" style="text-align: right;">
                    <button mat-flat-button
                            type="button"
                            class="BC-Gov-PrimaryButton"
                            style="width: 250px; float:right;"
                            (click)="sendContact()">
                      Send
                    </button>
                  </div>
                </div>
              </div>
              </div>
           </form>
        </mat-tab>
      </mat-tab-group>
    </div>
  </section>
  <div class="footer row">
    <span class="icon-col col-md-1">
      <img class="icon-size5" src="/assets/Support_icon.svg" />
    </span>
    <div class="col-md-11">
      <h1>
        <strong>Have questions or Looking for more support?</strong>
      </h1>
      <p class="text-body">
        Contact the Recalculation Service toll free
        <a href="tel:+18776618026">1-877-661-8026</a>,
        or learn more about the progrom
      </p>
    </div>
  </div>
</div>
